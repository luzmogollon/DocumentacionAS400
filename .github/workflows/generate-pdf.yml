name: Generar PDF

on:
  push:
    branches:
      - main
      - master
    paths:
      - 'Luz_Maria_Mogollon.md'
  workflow_dispatch:

jobs:
  generate-pdf:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout código
        uses: actions/checkout@v4
        
      - name: Instalar pandoc y LaTeX
        run: |
          sudo apt-get update
          sudo apt-get install -y pandoc texlive-xetex texlive-lang-spanish
          
      - name: Generar PDF
        run: |
          pandoc Luz_Maria_Mogollon.md \
            -o Luz_Maria_Mogollon.pdf \
            --pdf-engine=xelatex \
            -V geometry:margin=1in \
            -V lang=es \
            --toc \
            --toc-depth=2
            
      - name: Verificar PDF generado
        run: |
          ls -lh Luz_Maria_Mogollon.pdf
          file Luz_Maria_Mogollon.pdf
          
      - name: Commit y push del PDF actualizado
        run: |
          git config --local user.email "github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"
          git add Luz_Maria_Mogollon.pdf
          git diff --staged --quiet || git commit -m "Actualizar PDF generado automáticamente"
          git push
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
